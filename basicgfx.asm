
	org $BFF0
	db "NES",$1a
	db $1
	db $1
	db %00000000
	db %00000000
	db 0
	db 0,0,0,0,0,0,0


curs_x equ $40
curs_y equ curs_x+1

vblanked equ $7f


nmihandler:
	pha
	php
		inc vblanked
	plp
	pla

backgroundupdate:
	ldx #$20
	stx $2006
	ldx #$00
	stx $2006
	ldx #$00
	stx $2007
	stx $2007

	
	ldx #$00 	; Set SPR-RAM address to 0
	stx $2003
spriteloop:
	lda hello,x
	sta $2004
	inx
	cpx #$20
	bne spriteloop

	lda $2002
	lda #$20
	sta $2006
	lda #$00
	sta $2006

	rti
	

irqhandler:
	rti


startgame:
	sei
	cld

	ldx #$ff
	txs
	
	lda $2002
	ldx #$3F
	stx $2006
	ldx #$00
	stx $2006
copypalloop:
	lda initial_palette,x
	sta $2007
	inx
	cpx #$20
	bcc copypalloop

	lda $2002
	lda #$20
	sta $2006	
	ldx #$00
	stx $2006



bkgd:
	lda backgrounddata,x
	sta $2007
	inx
	cpx #$00
	bne bkgd
bkgd2:
	lda backgrounddata+256,x
	sta $2007
	inx
	cpx #$00
	bne bkgd2
bkgd3:
	lda backgrounddata,x
	sta $2007
	inx
	cpx #$00
	bne bkgd3
bkgd4:
	lda backgrounddata+256,x
	sta $2007
	inx
	cpx #$00
	bne bkgd4
	

	lda #%00011110
	sta $2001
	lda #$90
	sta $2000




forever:
	jmp forever



initial_palette:
	db $1F,$21,$33,$30
	db $1F,$21,$33,$30
	db $1F,$21,$33,$30
	db $1F,$21,$33,$30
	db $1F,$21,$33,$30
	db $1F,$21,$33,$30
	db $1F,$21,$33,$30
	db $1F,$21,$33,$30


hello:
	;db $00, $00, $00, $00 	; Why do I need these here?
	;db $00, $00, $00, $00
	db $6c, $FD, $00, $35
	db $6c, $FE, $00, $3d
	db $6c, $FD, $00, $55
	db $6c, $FE, $00, $5d
	db $6c, $FD, $00, $75
	db $6c, $FE, $00, $7d
	db $6c, $FD, $00, $95
	db $6c, $FE, $00, $9d
	
backgrounddata:
	
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$12,$25,$15,$18,$1F,$0E,$25,$22,$18,$1E,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$15,$12,$1C,$0A,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25

	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25
	db $25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25,$25



	org $FFFA
	dw nmihandler
	dw startgame
	dw irqhandler

CHRROM_START:

	incbin "mario.chr"

CHRROM_END:

; Pad chr-rom to 8k(to make valid file)
	ds 8192-(CHRROM_END-CHRROM_START)

